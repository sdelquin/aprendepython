---
icon: material/translate
---

# Internacionalizaci칩n { #i18n }

<span class="djversion advanced">:simple-django: Avanzado :material-tag-multiple-outline:</span>

En desarrollo web, la **internacionalizaci칩n** (`i18n`)[^1] es el proceso de preparar una aplicaci칩n o sitio web para que pueda adaptarse f치cilmente a m칰ltiples idiomas, formatos de fecha, monedas y otras diferencias culturales, sin necesidad de realizar cambios significativos en el c칩digo base.

Django ofrece [mecanismos](https://docs.djangoproject.com/en/stable/topics/i18n/translation/) para facilitar la tarea de internacionalizar una aplicaci칩n web.

## Marcado { #mark }

El **marcado** es el proceso por el cual se le indica a Django qu칠 partes de nuestro software deben ser traducidos. Se diferencian dos contextos:

:one: Marcado en plantillas.  
:two: Marcado en vistas.

### Marcado en plantillas { #mark-templates }

Podemos 춺marcar췉 para traducci칩n cadenas de texto o variables en plantillas. Para ello, Django nos ofrece la [etiqueta de plantilla](templates.md#tags): [`translate`](https://docs.djangoproject.com/en/stable/topics/i18n/translation/#translate-template-tag).

Por <span class="example">ejemplo:material-flash:</span>:

```htmldjango
{% load i18n %}<!--(1)!-->

<p>{% translate "Check out this section" %}</p><!--(2)!-->
<p>{% translate message %}</p><!--(3)!-->
```
{ .annotate }

1. Cargar las funcionalidades de internacionalizaci칩n
2. Funciona con literales.
3. Funciona con variables.

### Marcado en vistas { #mark-views }

Podemos 춺marcar췉 para traducci칩n cadenas de texto o variables en vistas. Para ello, Django nos ofrece la funci칩n: [`gettext()`](https://docs.djangoproject.com/en/stable/ref/utils/#django.utils.translation.gettext).

Por <span class="example">ejemplo:material-flash:</span>:

```python hl_lines="2 6"
from django.shortcuts import render
from django.utils.translation import gettext as _#(1)!


def info(request):
    message = _('Check out this section')#(2)!
    render(request, 'info.html', {'message': message})
```
{ .annotate }

1.  - Importamos la funci칩n.
    - Aunque no es obligatorio, suele ser habitual definir el alias `_`
2.  - Pasamos la cadena de texto que queremos marcar para traducci칩n.
    - Tambi칠n funciona con variables.

## Ficheros de idioma { #language-files }

Una vez marcadas las cadenas de texto para traducci칩n, debemos crear los ficheros de idioma.

Supongamos por <span class="example">ejemplo:material-flash:</span> que estamos desarrollando un 춺blog췉 en ingl칠s pero ^^queremos a침adir traducci칩n al espa침ol^^.

Lo primero ser치 marcar contenido para traducci칩n. En este caso en una plantilla de la aplicaci칩n `posts`:

```htmldjango title="posts/templates/posts/add.html" linenums="1" hl_lines="2 8"
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<form method="post" novalidate>
    {% csrf_token %}
    {{ form }}
    <button type="submit">{% translate "Add post" %}</button>
</form>
{% endblock %}
```

### Crear ficheros de idioma { #makemessages }

Django proporciona el comando [`makemessages`](https://docs.djangoproject.com/en/stable/ref/django-admin/#django-admin-makemessages) para crear los ficheros de idioma. Pero antes de lanzarlo, debemos ==crear en todas las aplicaciones== la subcarpeta `locale`.

??? abstract "justfile"

    Consulta la receta [`makelocale`](justfile.md#django-justfile) para incluirla en tu `justfile`.

Ahora ya podremos lanzar el comando que crea los ficheros de idioma:

=== "*venv* :octicons-package-24:{.blue}"

    ```console
    $ ./manage.py makemessages -l es #(1)!
    ```
    { .annotate }

    1.  - Se ha utilizado `es` porque vamos a generar traducciones para espa침ol. Habr칤a que adaptar el c칩digo seg칰n corresponda.
        - En el propio c칩digo fuente del proyecto Django se puede encontrar el [listado con los c칩digos de idioma](https://github.com/django/django/blob/main/django/conf/global_settings.py#L53) existentes.

=== "*uv* &nbsp;:simple-uv:{.uv}"

    ```console
    $ uv run ./manage.py makemessages -l es #(1)!
    ```
    { .annotate }

    1.  - Se ha utilizado `es` porque vamos a generar traducciones para espa침ol. Habr칤a que adaptar el c칩digo seg칰n corresponda.
        - En el propio c칩digo fuente del proyecto Django se puede encontrar el [listado con los c칩digos de idioma](https://github.com/django/django/blob/main/django/conf/global_settings.py#L53) existentes.

    ??? abstract "justfile"

        Consulta la receta [`makemessages`](justfile.md#django-justfile) para incluirla en tu `justfile`.

El comando anterior crear치 un fichero `posts/locale/es/LC_MESSAGES/django.po` con aquellas cadenas marcadas para traducir. Ahora tendremos que abrir dicho fichero en alg칰n editor de texto y completar las entradas `msgstr` ^^con la traducci칩n al espa침ol^^:

```po title="posts/locale/es/LC_MESSAGES/django.po" hl_lines="22-23"
# SOME DESCRIPTIVE TITLE.
# Copyright (C) YEAR THE PACKAGE'S COPYRIGHT HOLDER
# This file is distributed under the same license as the PACKAGE package.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: PACKAGE VERSION\n"
"Report-Msgid-Bugs-To: \n"
"POT-Creation-Date: 2025-11-25 12:24+0000\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"Language: \n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"
"Plural-Forms: nplurals=3; plural=n == 1 ? 0 : n != 0 && n % 1000000 == 0 ? "
"1 : 2;\n"
#: posts/templates/posts/post/add.html:8
msgid "Add post"
msgstr "A침adir post"
```

### Compilar ficheros de idioma { #compilemessages }

Con las traducciones completadas, ahora viene la fase de **compilaci칩n** de los ficheros de idioma. Para ello Django proporciona el comando [`compilemessages`](https://docs.djangoproject.com/en/stable/ref/django-admin/#django-admin-compilemessages).

Ejecutamos el siguiente comando:

=== "*venv* :octicons-package-24:{.blue}"

    ```console
    $ ./manage.py compilemessages -i .venv #(1)!
    ```
    { .annotate }
    
    1. Ignoramos la carpeta del entorno virtual `.venv` ya que tambi칠n contiene marcas de traducci칩n (para el propio sistema base Django).

=== "*uv* &nbsp;:simple-uv:{.uv}"

    ```console
    $ uv run manage.py compilemessages -i .venv #(1)!
    ```
    { .annotate }
    
    1. Ignoramos la carpeta del entorno virtual `.venv` ya que tambi칠n contiene marcas de traducci칩n (para el propio sistema base Django).

    ??? abstract "justfile"

        Consulta la receta [`compilemessages`](justfile.md#django-justfile) para incluirla en tu `justfile`.

Este comando crear치 un fichero `posts/locale/es/LC_MESSAGES/django.mo` con la versi칩n compilada del fichero de idioma.

## Cambio de idioma { #lang-switch }

Ahora que ya tenemos las traducciones completadas y los ficheros de idioma preparados, tendremos que encontrar el modo de permitir al usuario cambiar el idioma a conveniencia.

Lo primero ser치 a침adir un 춺middleware췉 que permita individualizar la elecci칩n de idioma. Para ello tocaremos algunas l칤neas del fichero `settings.py`:

```python title="main/settings.py" hl_lines="4"
MIDDLEWARE = [
    # ...
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.locale.LocaleMiddleware',
    'django.middleware.common.CommonMiddleware',
    # ...
]
```

Y a continuaci칩n habr치 que definir un artefacto que nos permita cambiar de idioma:

=== "URL"

    ```python title="main/urls.py" hl_lines="9"
    from django.contrib import admin
    from django.urls import include, path
    
    import shared.views

    urlpatterns = [
        # ...
        path('admin/', admin.site.urls),
        path('setlang/<str:langcode>/', shared.views.setlang, name='setlang'),#(1)!
        # ...
    ]
    ```
    { .annotate }
    
    1. La URL define un par치metro `langcode` que contendr치 el c칩digo del idioma a fijar.

=== "Vista"

    ```python title="shared/views.py"
    from django.conf import settings#(1)!
    from django.shortcuts import redirect#(2)!
    from django.utils import translation#(3)!


    def setlang(request, langcode):#(4)!
        next = request.GET.get('next', '/')#(5)!
        translation.activate(langcode)#(6)!
        response = redirect(next)#(7)!
        response.set_cookie(settings.LANGUAGE_COOKIE_NAME, langcode)#(8)!
        return response#(9)!
    ```
    { .annotate }
    
    1. Necesitamos las configuraciones de Django.
    2. Necesitamos redireccionar una vez cambiado el idioma.
    3. Necesitamos el objecto `translation` para manejar la activaci칩n de idioma.
    4. La vista recibe un _c칩digo de idioma_ (p. ej. `en` o `es`).
    5. Puede venir una URL siguiente mediante 춺querystring췉. Si no viene, por defecto ser치 el ra칤z `/`
    6. Activamos el idioma que recibimos en la vista.
    7. Creamos la respuesta en modo redirecci칩n a la URL siguiente.
    8. Creamos la 춺cookie췉 `django_language` que fijar치 el idioma (`en`, `es`, ...) para toda la sesi칩n.
    9. Retornamos la respuesta (_redirecci칩n efectiva_).

Una vez hecho esto, ya podemos incorporar enlaces en nuestro proyecto que nos permitan cambiar de idioma, haciendo uso de la URL con nombre que hemos definido previamente.

Un <span class="example">ejemplo:material-flash:</span> podr칤an ser los siguientes enlaces para traducir a _ingl칠s_ o a _espa침ol_:

```htmldjango title="shared/templates/setlang.html"
<a href="{% url 'setlang' 'en' %}?next={{ request.path }}">游쥟릖</a>
<a href="{% url 'setlang' 'es' %}?next={{ request.path }}">游쀯릖</a>
```

La plantilla anterior se podr칤a entonces incluir desde alguna plantilla base muy f치cilmente:

```htmldjango title="shared/templates/base.html"
<!-- some code -->
<body>
  {% include "setlang.html" %}
  {% block content %}{% endblock %}
</body>
<!-- some code -->
```

??? tip "Etiqueta personalizada"

    Podr칤a resultar adecuado implementar el 춺m칩dulo췉 de cambio de idioma a trav칠s de una [etiqueta personalizada](templates.md#custom-tags) con una plantilla de inclusi칩n que tuviera, por ejemplo, un desplegable con todos los posibles idiomas del proyecto.

    A continuaci칩n se presenta un <span class="example">ejemplo:material-flash:</span> de ^^etiqueta personalizada^^ que define un desplegable de idiomas para utilizar dentro un 춺[navbar](https://getbootstrap.com/docs/5.3/components/navbar/)췉 de [Bootstrap](static.md#bootstrap):

    === "Etiqueta"
    
        ```python title="shared/templatetags/shared_extras.py"
        @register.inclusion_tag('includes/setlang.html', takes_context=True)
        def setlang(context):
            LANGUAGES = {
                'en': '游쥟릖',
                'es': '游쀯릖',
            }
        
            current_lang = get_language()
            current_flag = LANGUAGES.pop(current_lang)
            next = context['request'].path
            return {
                'current_lang': current_lang,
                'current_flag': current_flag,
                'languages': LANGUAGES,
                'next': next,
            }
        ```
    
    === "Plantilla"
    
        ```htmldjango title="shared/templates/includes/setlang.html"
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            {{ current_flag }}
          </a>
          <ul class="dropdown-menu dropdown-menu-end dropdown-lang">
            {% for lang, flag in languages.items %}
              <li>
                <a class="dropdown-item nav-link" href="{% url 'setlang' lang %}?next={{ next }}">{{ flag }}</a>
              </li>
            {% endfor %}
          </ul>
        </li>
        ```
    
    === "Uso"
    
        ```htmldjango
        {% setlang %}
        ```     
    
        

[^1]: **i18n** es la abreviatura de 춺internacionalizaci칩n췉 :material-arrow-right-box: `[i (18 caracteres) n]`
